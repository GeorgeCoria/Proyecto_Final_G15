<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
	<link th:rel="stylesheet" type="text/css" th:href="@{/webjars/bootstrap/4.5.0/css/bootstrap.min.css}">
    <link th:rel="stylesheet" type="text/css" th:href="@{/css/admin.css}">

    <title>adminPrincipal</title>
  </head>

  <body>
  	
  		
  <!-- ********** Insercion del header **************** -->
  	<div th:insert="layout/header :: header"></div> 

<!-- ****************  Panel de navegacion*********************  -->
   		<div class="nav bg-dark pt-3 pb-3 font-weight-bold mb-5 fuente">
  			<div class="col-8">
	  			<ul class="nav nav-tabs ">
					
			  		<li class="nav-item">
			   			 <a class="nav-link text-white" th:href="@{/adminLocalidad}">Localidades</a>
			  		</li>

			 		<li class="nav-item">
			   			 <a class="btn btn-primary font-weight-bold " th:href="@{/adminFormulario}">AÃ±adir Usuario</a>
			  		</li>  
				</ul>

  			</div>
  		
			<div class="col-4 pr-4" th:if="${principal}">
				<form class=" float-right form-inline my-2 my-lg-0" th:object="${usuarioBuscado}" th:action="@{/adminBusqueda}" method="post"> <!-- th:object="${usuarioBuscado}" th:action="@{/buscarDni}" method="post" --> 
		     		<input class="form-control mr-sm-2" th:field="${usuarioBuscado.nombreUsuario}" type="search" placeholder="Search by Nombre Usuario" aria-label="Search"> <!--  th:field="${usuarioBuscado.dni}" -->
		    	  	<input class="btn btn-primary my-2 my-sm-0" type="submit" value="BUSCAR">
		    	</form>
			</div>
	  	</div>
<!-- **************** Find de la barra de navegacion*********************  -->



<!-- **************** Cuerpo Gestor de Usuarios *********************  -->
	<div class="alert alert-danger text-center" th:if="${errorBusqueda}" th:text="${errorBusqueda}">Message Error</div>
	
	<div class="container fuente">
	
		<div class="btn-group mb-5 ">
			<a class="btn btn-primary btn-lg" th:href="@{/adminPrincipal}" >
			Lista de usuarios
			</a>
			
			<a class="btn btn-primary btn-lg" th:href="@{/Registrador}">
			Registradores
			</a>
			
			<a class="btn btn-primary btn-lg" th:href="@{/Consultor}" >
			Consultores
			</a>
			
			<a class="btn btn-danger btn-lg" th:href="@{/Suspendido}" >
			Suspendidos
			</a>
		</div>

		
<!-- **************** Cuerpo Gestor de Usuarios *********************  -->

		<div>

			<div class="row justify-content-center mb-4" th:if="${principal}">
				<h1 class=" w-100 p-2 text-center "
					style="border-top: 3px dodgerblue solid; border-bottom: 3px dodgerblue solid;">GESTOR
					DE USUARIOS</h1>
			</div>
			
			<div class="row justify-content-center mb-4" th:if="${registrador}">
				<h1 class=" w-100 p-2 text-center "
					style="border-top: 3px dodgerblue solid; border-bottom: 3px dodgerblue solid;">REGISTRADORES</h1>
			</div>
			
			<div class="row justify-content-center mb-4" th:if="${consultor}">
				<h1 class=" w-100 p-2 text-center "
					style="border-top: 3px dodgerblue solid; border-bottom: 3px dodgerblue solid;">CONSULTORES</h1>
			</div>
			
			<div class="row justify-content-center mb-4" th:if="${suspendido}">
				<h1 class=" w-100 p-2 text-center "
					style="border-top: 3px dodgerblue solid; border-bottom: 3px dodgerblue solid;">Usuarios dados de baja</h1>
			</div>
			
			<div class="my-custom-scrollbar1 table-wrapper-scroll-y">
				<table class="table table-reponsive-sm table-striped">
					<thead>
						<tr>
							<th scope="col">ID</th>
							<th scope="col">Usuario</th>
							<th scope="col">Nombre</th>
							<th scope="col">Apellido</th>
							<th scope="col">Tipo de Usuario</th>
							<th th:if="${busqueda} or ${suspendido}"scope="col">Estado</th>
							<th scope="col">Accion</th>
						</tr>
					</thead>

					<tbody>
						
						
						<tr th:each="usuario : ${listaUsuarios}">
							<th th:text="${usuario.id}"></th>
							<td th:text="${usuario.nombreUsuario}"></td>
							<td th:text="${usuario.nombreReal}"></td>
							<td th:text="${usuario.apellidoReal}"></td>
							<td th:text="${usuario.tipoUsuario}"></td>
							<td th:if="${busqueda} or ${suspendido}" th:text="${usuario.estado==true}?'Habilitado':'Inhabilitado'"></td>
							<td>
								<a class="btn btn-primary" th:href="@{'/editarUsuario/'+${usuario.id}}">Editar</a> 
								<a th:if="not ${suspendido} and not ${busqueda}" href="#"  class="btn btn-danger" th:onclick="'javascript:confirmarEliminar(\''+${usuario.id}+'\');'">Eliminar</a>
								</td>
						</tr>

					</tbody>
				
				</table>
			
				<div class="alert alert-danger text-center"
				th:if="${listErrorMessage}" th:text="${listErrorMessage}">Error
				MEssage</div>
			</div>
			<!-- ***** Script para efectuar la baja de un Usuario ****** -->
			
		<script type="text/javascript">
			function confirmarEliminar(id){
				$('#bajaUsuario').modal('show');
				$("#idModalBajaUsuario").val(id);
			}
			
			function eliminarUsuario(){
				var id= $("#idModalBajaUsuario").val();
				window.location= "eliminarUsuario/"+id;
			}
		
		</script>
	
		<!-- Modal utilizado al eliminar un Usuario -->
		
		<div class="modal fade" id="bajaUsuario" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
		  <div class="modal-dialog modal-dialog-centered">
		    <div class="modal-content">
		      <div class="modal-header bg-dark text-white">
		        <h5 class="modal-title" id="exampleModalLabel">Eliminar Usuario</h5>
		        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
		          <span aria-hidden="true">&times;</span>
		        </button>
		      </div>
		      <div class="modal-body">
		        Presione confirmar para dar de baja al usuario
		      </div>
		      <input type="hidden" id="idModalBajaUsuario" name="userIdHiddenInput"/>
		      <div class="modal-footer">
		        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
		       	<button class="btn btn-primary" th:onclick="eliminarUsuario()">Confirmar</button>
		      </div>
		    </div>
		  </div>
		</div>
		<!-- Termina Modal -->
		
		</div>

		<!-- ********** FIn Gestor de Usuarios **************** -->	
	 
 	</div>
  	
  			
	<!-- Insercion del fragmento footer utlizando thymeleaf --> 
	<div th:insert="layout/footer :: footer"></div> 

	</body>
</html>